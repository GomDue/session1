# 🗂️ SQL 인덱스 및 키 개요

## 1. 개요
- 데이터베이스에서 **인덱스(index)** 는 검색 속도를 향상시키는 중요한 요소.
- **키(key)** 는 테이블 간의 관계를 설정하고, 각 행을 고유하게 식별하는 역할.
- 인덱스는 기본적으로 **PRIMARY KEY, UNIQUE KEY** 등의 제약 조건과 함께 사용됨.

<br/>

## 2. 기본 키 (Primary Key)
- 기본 키는 **각 행을 고유하게 식별**하는 역할을 하는 컬럼.
- PostgreSQL에서는 `SERIAL` 타입을 사용하여 **자동 증가 ID**를 설정할 수 있음.
  - 다른 SQL 언어들보다 쉽고 간결

### **사용 예시**
```sql
CREATE TABLE users (
    id SERIAL PRIMARY KEY,
    name VARCHAR(100),
    email VARCHAR(100) UNIQUE
);
```
- `SERIAL`을 사용하면 `id` 값이 **자동으로 증가**하며 중복되지 않음.
- `PRIMARY KEY`는 자동으로 **인덱스가 생성**되어 검색 속도를 높임.
- `UNIQUE` 제약 조건은 중복 데이터를 방지하고 **자동으로 인덱스를 생성**하여 검색을 최적화함.

<br/>

## 3. 인덱스(Index)란?
- **인덱스는 데이터 검색을 빠르게 하기 위한 구조** (`Shortcuts`)
- 인덱스를 추가하면 데이터베이스가 **추가적인 정보를 저장**하여 검색을 최적화함.
- PostgreSQL에서 인덱스를 직접 생성할 수도 있음.

### **사용 예시**
```sql
CREATE INDEX idx_users_email ON users(email);
```
- 특정 컬럼(`email`)에 대해 **인덱스를 생성**하면 검색 속도가 향상됨.
- 인덱스를 추가하면 **정렬 및 검색 속도**가 빨라짐.

<br/>


## 4. B-트리 (B-Tree) 인덱스
- PostgreSQL에서 가장 일반적으로 사용되는 인덱스 유형.
- 데이터가 **정렬된 상태**에서 범위를 검색하는 데 유용함.
- **사용 예시:**
  - `ORDER BY`를 통한 정렬.
  - 특정 값 범위(`BETWEEN`, `>=`, `<=`) 검색.
  - **문자열 검색 (`LIKE 'abc%'`)**도 지원하지만, 전체 `%abc%` 검색은 비효율적.

### **B-트리 인덱스의 특징**
- 검색, 정렬, 범위 조회에 최적화됨.
- 자동으로 균형을 유지하여 **일관된 성능** 제공.
- **UNIQUE KEY는 기본적으로 B-트리 인덱스 사용**.


<br/>


## 5. 해시(Hash) 인덱스
- **문자열을 숫자로 변환하고 특정 위치로 매핑**하는 방식
- **정확한 값 매칭(Exact Match)에 최적화**된 인덱스 유형.
- 해시 인덱스는 **정렬 및 범위 검색에는 적합하지 않음**.
- **사용 예시:**
  - 기본 키 또는 GUID(글로벌 유니크 식별자) 검색.
  - 특정 ID 조회 (`WHERE id = 1234`).
  
### **해시 인덱스의 특징**
- 정확한 값 검색 (`WHERE email = 'example@test.com'`)에 매우 빠름.
- 데이터가 정렬되지 않기 때문에 `ORDER BY`, `BETWEEN`과 함께 사용 불가.
- PRIMARY KEY의 경우 일반적으로 **해시 인덱스가 자동 적용될 가능성이 높음**.

### **해시 인덱스 생성 예시**
```sql
CREATE INDEX idx_users_email_hash ON users USING HASH(email);
```

<br/>


## 6. 인덱스 성능 최적화
### 6.1 인덱스를 사용하면 좋은 경우
✅ **대량의 데이터를 빠르게 검색할 때** \
✅ **WHERE 절을 자주 사용하여 특정 컬럼을 조회할 때** \
✅ **JOIN 연산을 할 때 키를 빠르게 찾을 필요가 있을 때** \
✅ **ORDER BY 및 GROUP BY 연산을 최적화할 때**

### 6.2 인덱스를 피해야 하는 경우
❌ **자주 업데이트되는 컬럼에 인덱스를 설정하면 성능 저하 발생**
❌ **소량의 데이터(몇 천 개 이하)에서는 오히려 성능이 낮을 수 있음**
❌ **WHERE 조건 없이 전체 데이터를 조회할 경우 효과가 없음**

<br/>


## 7. 인덱스와 데이터베이스 크기
- 인덱스를 추가하면 **더 많은 디스크 공간을 사용**하지만, 검색 속도는 향상됨.
- 인덱스가 많아지면 데이터 삽입/수정 시 성능이 저하될 수도 있음.
- 최적의 성능을 위해 **자주 조회하는 컬럼에만 인덱스를 추가**하는 것이 중요.


